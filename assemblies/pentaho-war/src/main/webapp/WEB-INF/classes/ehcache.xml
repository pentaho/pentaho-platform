<config xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
        xmlns='http://www.ehcache.org/v3'
        xsi:schemaLocation="http://www.ehcache.org/v3 http://www.ehcache.org/schema/ehcache-core-3.0.xsd">
  <!-- Sets the path to the directory where cache .data files are created.

       If the path is a Java System Property it is replaced by
       its value in the running VM.

       The following properties are translated:
       user.home - User's home directory
       user.dir - User's current working directory
       java.io.tmpdir - Default temp file path -->
  <!--  <persistence directory="${user.home}/.pentaho/caches/ehcache"/>-->

  <!-- Default cache configuration for cache with store-by-reference configuration (store-by-value=false)
       Using IdentityCopier to avoid copying objects, giving store-by-reference behavior
       This is used by HvCacheRegionFactory as a fallback when a specific cache configuration is not found
       When heap is full, entries overflow to disk (10MB allocated) if disk resource(like <disk unit="MB" persistent="false">10</disk> in resource tag)
       When there is no expiry tag means the cache is eternal. Add expiry tag to configure the expiry for cache-->
  <cache alias="defaultCache">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">1000</heap>
    </resources>
  </cache>

  <cache alias="pentahoCache">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">600</ttl>
    </expiry>
    <resources>
      <heap unit="entries">15000</heap>
      <offheap unit="MB">100</offheap>
    </resources>
  </cache>

  <cache alias="libloader-data">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">1000</heap>
      <offheap unit="MB">100</offheap>
    </resources>
  </cache>

  <!-- Defines a cache used by libloader. This cache holds the raw binary data loaded via libloader.  -->
  <cache alias="libloader-bundles">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">100</heap>
    </resources>
  </cache>

  <!-- Defines a cache used by libloader. This cache holds the parsed object loaded via libloader. -->
  <cache alias="libloader-factory">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">1000</heap>
    </resources>
  </cache>

  <cache alias="mondrian-catalog-cache">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">30</heap>
    </resources>
  </cache>


  <!--
    Defines a cache used by the reporting engine to hold small datasets.
    This cache can be configured to have a separate instance for each logged in user via the
    global report configuration. This per-user cache is required if role or other security and
    filter information is used in ways invisible for the reporting engine.
  -->
  <cache alias="report-dataset-cache">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">600</ttl>
    </expiry>
    <resources>
      <heap unit="entries">50</heap>
    </resources>
  </cache>

  <!--
     Defines a cache used by the reporting plugin to hold paginated report objects.
     Warning: These report keep their connections open as long as the report object
     lives in the cache. This cache exists on a per-user basis. Keep it reasonably
     small to not exhaust your resources.
  -->
  <cache alias="report-output-handlers">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">10</heap>
    </resources>
  </cache>
  <!-- Repository File Entity caching below. These are used by the Hibernate 2nd-level cache when using the ehCache provider. -->
  <cache alias="org.pentaho.platform.repository.solution.dbbased.RepositoryFile">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">600</ttl>
    </expiry>
    <resources>
      <heap unit="entries">10000</heap>
      <offheap unit="MB">50</offheap>
    </resources>
  </cache>

  <cache alias="org.pentaho.platform.repository.solution.dbbased.RepositoryFile.childrenFiles">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">600</ttl>
    </expiry>
    <resources>
      <heap unit="entries">10000</heap>
      <offheap unit="MB">50</offheap>
    </resources>
  </cache>

  <cache alias="org.pentaho.platform.repository.solution.dbbased.RepositoryFile.accessControls">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">600</ttl>
    </expiry>
    <resources>
      <heap unit="entries">10000</heap>
      <offheap unit="MB">50</offheap>
    </resources>
  </cache>

  <cache alias="pentaho-geo-country">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">1000</heap>
    </resources>
  </cache>

  <cache alias="pentaho-geo-countrycode">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">5000</heap>
    </resources>
  </cache>

  <cache alias="pentaho-geo-countrycode3">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">5000</heap>
    </resources>
  </cache>

  <cache alias="pentaho-geo-countrysubdivision">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">5000</heap>
    </resources>
  </cache>

  <cache alias="pentaho-geo-countrysubdivisioncode">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">5000</heap>
    </resources>
  </cache>

  <cache alias="pentaho-geo-countrysecondarysubdivision">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">5000</heap>
    </resources>
  </cache>

  <cache alias="pentaho-geo-postalcode">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">50000</heap>
    </resources>
  </cache>
  <cache alias="pentaho-geo-municipality">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <resources>
      <heap unit="entries">700000</heap>
    </resources>
  </cache>
  <!-- When creating a custom geographic role that exceeds 1000 elements use this template -->
  <!--

    <cache alias="pentaho-geo-{CUSTOM_ROLE_TYPE}">
      <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
      <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
      <resources>
        <heap unit="entries">50000</heap>
      </resources>
    </cache>
  -->

  <!-- Cache for the Spring CachingUserDetailsService -->
  <cache alias="userCache">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">600</ttl>
    </expiry>
    <resources>
      <heap unit="entries">2000</heap>
    </resources>
    <!-- Ehcache 3.x does not support timeToIdleSeconds and timeToLiveSeconds directly. You can use Expiry API instead -->

  </cache>

  <cache alias="userRoleListCache">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">600</ttl>
    </expiry>
    <resources>
      <heap unit="entries">2000</heap>
    </resources>
  </cache>

  <cache alias="principalProviderRoleCache">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">600</ttl>
    </expiry>
    <resources>
      <heap unit="entries">512</heap>
    </resources>
  </cache>

  <cache alias="principalProviderUserCache">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">600</ttl>
    </expiry>
    <resources>
      <heap unit="entries">4092</heap>
    </resources>
  </cache>

  <!-- Caches for the PentahoCachingLdap* classes. Only enable if they are in use.

  <cache alias="ldapPopulatorCache">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">600</ttl>
    </expiry>
    <resources>
      <heap unit="entries">2000</heap>
    </resources>
  </cache>

  <cache alias="ldapAuthenticatorCache">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">600</ttl>
    </expiry>
    <resources>
      <heap unit="entries">2000</heap>
    </resources>
  </cache>
  -->

  <!-- Cache backing the CachingRepositoryFactory which creates PDI Repository instances in the platform -->
  <cache alias="pdi-repository-cache">
    <key-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</key-type>
    <value-type copier="org.ehcache.impl.copy.IdentityCopier">java.lang.Object</value-type>
    <expiry>
      <ttl unit="seconds">240</ttl>
    </expiry>
    <resources>
      <heap unit="entries">2000</heap>
    </resources>
  </cache>
</config>
